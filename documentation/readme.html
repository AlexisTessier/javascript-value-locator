<doctype>
<html>
<head>
<link rel="stylesheet" href="/github-markdown.css">
</head>
<body>
<style>
	.markdown-body {
		box-sizing: border-box;
		min-width: 200px;
		max-width: 980px;
		margin: 0 auto;
		padding: 45px;
	}
</style>
<div class="markdown-body">
<h1 id="javascript-value-locator">Javascript Value Locator</h1>
<p>Load javascript values from multiples sources and using multiple protocols</p>
<h2 id="introduction">Introduction</h2>
<p>This module provide a minimalist api to load (<strong>asynchronously only</strong>) javascript values from different sources, using <strong>javascript value locators</strong> - <strong><em>JVL</em></strong>. A <strong><em>JVL</em></strong> is an object or a string (matching a specific format), which represent a way to load a javascript value. It&#39;s composed both of a <strong>protocol</strong> and a <strong>target</strong>.</p>
<pre><code class="lang-javascript">//this is a jvl object
{
    protocol: &#39;require&#39;,
    target: &#39;full/path/to/module/exporting/the/targeted/value&#39;
}

//this is the equivalent jvl string
&#39;require:full/path/to/module/exporting/the/targeted/value&#39;
</code></pre>
<p>You can see this module as a kind of <a href="https://webpack.js.org/">webpack</a> at the run time, where protocols are loaders, and where instead of doing this :</p>
<pre><code class="lang-javascript">require.ensure([], require =&gt; {
    const value = require(&#39;module/path&#39;);
})
</code></pre>
<h2 id="about-the-documentation">About the documentation</h2>
<p>The following documentation is also available in a more convenient format <a href="/index.html">here : url</a></p>
<h3 id="naming-conventions">Naming conventions</h3>
<ul>
<li>CapitalizedCamelCasedNames are used for types <a href="https://en.wikipedia.org/wiki/Duck_typing">see ducktyping</a></li>
</ul>
<ul>
<li>dashified-case-names are used for filenames</li>
</ul>
<ul>
<li>camelCasedNames are used for methods and properties</li>
</ul>
<h2 id="documentation">Documentation</h2>
<!-- Generated by documentation.js. Update this documentation by updating the source code. -->
<h3 id="javascriptvaluelocator">JavascriptValueLocator</h3>
<p>A JavascriptValueLocator (JVL) is a <a href="#javascriptvaluelocatorstring">string</a> or an <a href="#javascriptvaluelocatorobject">object</a> which describe a way to access to a javascript value.
It must provide at least:</p>
<ul>
<li><a href="#javascriptvaluelocatorprotocol">A protocol (JavascriptValueLocatorProtocol)</a> </li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String">A target as a string</a></li>
</ul>
<p>Type: (<a href="#javascriptvaluelocatorstring">JavascriptValueLocatorString</a> | <a href="#javascriptvaluelocatorobject">JavascriptValueLocatorObject</a>)</p>
<h3 id="javascriptvaluelocatorstring">JavascriptValueLocatorString</h3>
<p>A JavascriptValueLocatorString (JVL string) is a string which describe a way to access to a javascript value. It must matches the following format:</p>
<ul>
<li>protocol-name:target-name <a href="#javascriptvaluelocator">see JavascriptValueLocator</a></li>
</ul>
<p>Type: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String">string</a></p>
<p><strong>Examples</strong></p>
<pre><code class="lang-javascript">// Those are valid JVL strings
&quot;require:/path/to/file&quot;
&quot;any-defined-protocol-name:any-target-name_case is-NotImportant&quot;

// Those are unvalid JVL strings
&quot;:target-name&quot; // Missing protocol
&quot;protocol-name&quot; // Missing target
</code></pre>
<h3 id="javascriptvaluelocatorobject">JavascriptValueLocatorObject</h3>
<p>A JavascriptValueLocatorObject is an object which describe a way to access to a javascript value.</p>
<p>Type: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object">object</a></p>
<p><strong>Properties</strong></p>
<ul>
<li><code>protocol</code> <strong>(<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String">string</a> | <a href="#javascriptvaluelocatorprotocol">JavascriptValueLocatorProtocol</a>)</strong> The name of the protocol or the protocol himself (as a function which respect the <a href="#javascriptvaluelocatorprotocol">JavascriptValueLocatorProtocol definition</a>)</li>
<li><code>target</code> <strong><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String">string</a></strong> The javascript value targeted.</li>
</ul>
<h3 id="javascriptvaluelocatorprotocol">JavascriptValueLocatorProtocol</h3>
<p>A JavascriptValueLocatorProtocol is a function which take the following arguments (resolve, reject, target, options) and resolve the targeted javascript value or reject an error</p>
<p>Type: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/function">function</a></p>
<p><strong>Parameters</strong></p>
<ul>
<li><code>resolve</code> <strong><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/function">function</a></strong> A resolve function which will be called with the targeted javascript value as single argument</li>
<li><code>reject</code> <strong><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/function">function</a></strong> A reject function which will be called with a error as single argument if the javascript value load failed</li>
<li><code>target</code> <strong><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String">string</a></strong> The target to load and resolve. A target must be a unique identifier/path (or maybe other things depending on the used protocol) to the requested javascript value. You must use it to know which value is requested</li>
<li><code>options</code> <strong><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object">object</a></strong> The options passed to the protocol.</li>
</ul>
<h3 id="javascript-value-locator">javascript-value-locator</h3>
<p>The JVL API is an object providing the following properties:</p>
<ul>
<li><a href="#load">load</a></li>
<li><a href="#parse">parse</a></li>
<li><a href="#stringify">stringify</a></li>
<li><a href="#defaultprotocols">defaultProtocols</a></li>
</ul>
<p><strong>Examples</strong></p>
<pre><code class="lang-javascript">// require the public API
const JVL = require(&#39;javascript-value-locator&#39;)
// then use a method of the API
JVL.load(&#39;npm:string-humanize@1.0.0&#39;).then(_ =&gt; console.log(_(&#39;hello-world&#39;))) // Hello world
</code></pre>
<h3 id="load">load</h3>
<p>This function loads a javascript value in a async way</p>
<p><strong>Parameters</strong></p>
<ul>
<li><code>locator</code> <strong><a href="#javascriptvaluelocator">JavascriptValueLocator</a></strong> A javascript value locator as an object or a string which follow the JVL format.</li>
<li><code>options</code> <strong><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object">object</a>?</strong> The javascript options object which will be passed to the locator protocol function. If locator is an object, it can provide directly an options object which will be merged with the options parameter. (optional, default <code>{}</code>)</li>
<li><code>inject</code> <strong><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object">object</a>?</strong> A javascript object containing the load function dependencies. (optional, default <code>{}</code>)<ul>
<li><code>inject.protocols</code> <strong><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object">object</a></strong> A Dictionnary where keys are the names of the protocols and value are the protocols functions. If locator is an object, it can provide directly a protocols key which will be merged with the inject.protocols parameter. (optional, default <code>defaultProtocols</code>)</li>
</ul>
</li>
</ul>
<p>Returns <strong><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise">Promise</a></strong> A promise resolving the javascript value targeted by the locator.</p>
<h3 id="parse">parse</h3>
<p>This function returns a locator object from a JVL string</p>
<p><strong>Parameters</strong></p>
<ul>
<li><code>JVL</code> <strong><a href="#javascriptvaluelocatorstring">JavascriptValueLocatorString</a></strong> The locator as string to parse.</li>
</ul>
<p>Returns <strong><a href="#javascriptvaluelocatorobject">JavascriptValueLocatorObject</a></strong> The corresponding locator as an object.</p>
<h3 id="stringify">stringify</h3>
<p>This function transforms a locator object to a JVL string</p>
<p><strong>Parameters</strong></p>
<ul>
<li><code>locator</code> <strong><a href="#javascriptvaluelocatorobject">JavascriptValueLocatorObject</a></strong> The locator object to stringify.</li>
</ul>
<p>Returns <strong><a href="#javascriptvaluelocatorstring">JavascriptValueLocatorString</a></strong> The corresponding JVL string.</p>
<h3 id="defaultprotocols">defaultProtocols</h3>
<p>This object contains the defaults protocols defined by the javascript-value-locator package :</p>
<ul>
<li><a href="#require">require</a></li>
</ul>
<p>You can use it, for example, in order to create a new load functions with new custom protocols.</p>
<p><strong>Examples</strong></p>
<pre><code class="lang-javascript">//import the load function and the default-protocols
const {load, defaultProtocols} = require(&#39;javascript-value-locator&#39;)

//define some custom protocols
const customProtocols = {
    newProtocol: function(resolve, reject, target, options){
        resolve(getTheValueUsingTheTargetAndOptions)
        //or
        reject()
    }
}

//create and export a function which call the original function,
//but passing to it a new protocols object dependency
module.exports = function customLoad(locator, options){
    return load(locator, options, {
        protocols: Object.assign({}, defaultProtocols, customProtocols)
    })
}
</code></pre>
<h3 id="require">require</h3>
<p>This function is a <a href="#javascriptvaluelocatorprotocol">JavascriptValueLocatorProtocol</a> that use the node require function to load the target</p>
<p><strong>Parameters</strong></p>
<ul>
<li><code>resolve</code> <strong><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/function">function</a></strong> A resolve function which will be called with the targeted javascript value as single argument</li>
<li><code>reject</code> <strong><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/function">function</a></strong> A reject function which will be called with a error as single argument if the javascript value load failed</li>
<li><code>target</code> <strong><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String">string</a></strong> The target to load and resolve. It must be a path to a valid node module.</li>
</ul>

</div>
</body>
</html>